{% extends 'base.html' %}
{% block title %}{{ post.title_tag }}{% endblock %}

{% block content %}

<style>
	  .jumbotron-sm {
	    font-size: 14px;
	  }

	  .smaller-heading {
	    font-size: 40px; /* Adjust the size as needed */
	  }

	  .post-meta {
	    font-size: 15px;
	    color: #555;
	  }

	  .lead {
	    font-size: 18px;
		}
	</style>
	<div class="jumbotron jumbotron-sm">
		<h1 class="display-4 smaller-heading"><a href="{% url 'article-detail' post.pk %}">{{ post.title }}</a></h1>
	  	<p class="post-meta">Posted on - {{ post.post_date}}
	  	{% if user.is_authenticated %}
			{% if user.id == post.author.id %}
				<a href="{% url 'update_post' post.pk %}">(Edit)</a>
				<a href="#" data-toggle="modal" data-target="#deleteModal">(Delete)</a>

				<div class="modal" id="deleteModal" tabindex="-1" role="dialog">
				  <div class="modal-dialog" role="document">
				    <div class="modal-content">
				      <div class="modal-header">
				        <h5 class="modal-title">Confirm Deletion</h5>
				        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
				          <span aria-hidden="true">&times;</span>
				        </button>
				      </div>
				      <div class="modal-body">
				        <p>Are you sure you want to delete this post?</p>
				      </div>
				      <div class="modal-footer">
				        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				        <form method="POST" action="{% url 'delete_post' post.pk %}">
					  		{% csrf_token %}
					  		<button type="submit" class="btn btn-primary">Delete</button>
					  	</form>
				      </div>
				    </div>
				  </div>
				</div>
			{% endif %}
		{% endif %}
		</p>
	  	
	  	<form action="{% url 'like_post' post.pk %}" method="POST">
			{% csrf_token %}

			{% if user.is_authenticated %}

				{% if liked %}
					<button type="submit", name="post_id", value="{{ post.id }}", class="btn btn-danger btn-sm">Unlike</button> 

				{% else %}
					<button type="submit", name="post_id", value="{{ post.id }}", class="btn btn-primary btn-sm">Like</button> 

				{% endif %}

			{% else %}
				<small><a href="{% url 'login' %}">Login to like</a></small>

			{% endif %}
					- {{ total_likes }} Likes	
		</form> 

	  	<hr class="my-4">
	  	<p class="lead">{{ post.body|safe }}</p>
	
	</div>

	  	<h4>Comments</h4>	

	  	{% if user.is_authenticated %}
	  	<hr>
		  	{% if not post.comments.all %}
			  	<form method="POST" action="{% url 'add_comment' post.pk %}">
			  		{% csrf_token %}
			  		{{ comment_form.as_p }}
			  		<button type="submit" class="btn btn-primary btn-sm" style="float: right;">Comment</button>
			  	</form>
		  		<br>
		  				  	
		  	{% else %}
		  		<form method="POST" action="{% url 'add_comment' post.pk %}">
			  		{% csrf_token %}
			  		{{ comment_form.as_p }}
			  		<button type="submit" class="btn btn-primary btn-sm" style="float: right;">Comment</button>
		  		</form>
		  		<br>

		  		{% for comment in post.comments.all %}
		  			<strong>{{ comment.name }} - {{ comment.date_added }}</strong>
		  			<br>
		  			{{ comment.body }}
		  			<br>
		  		{% endfor %}
		  	{% endif %}
		{% else %}
			<small><a href="{% url 'login' %}">Login to comment</a></small>
			<hr>

			{% for comment in post.comments.all %}
	  			<strong>{{ comment.name }} - {{ comment.date_added }}</strong>
	  			<br>
	  			{{ comment.body }}
	  			<br>
	  		{% endfor %}
		{% endif %}
	  	<br>
		

	<script type="text/javascript">
		var name = "{{ user.username }}";
		document.getElementById('username').value = name;
	</script>

<hr>
<br>

{% endblock %}